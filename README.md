# TestDataGen

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## Description

TestDataGen is a domain-specific language for generating intelligent test data. The language is created for the purpose of the Domain-Specific Languages course at the Faculty of Technical Sciences, University of Novi Sad.

Unlike traditional fake data generators that produce purely random values, TestDataGen implements **smart test data generation strategies** based on established software testing techniques:

- **Boundary Value Analysis (BVA)** - Automatically generates values at and around boundaries where defects are most likely to occur
- **Equivalence Partitioning (EP)** - Divides input domains into equivalence classes and generates representative values from each partition
- **Edge Case Generation** - Produces special values like `null`, empty strings, and invalid formats to test error handling

TestDataGen enables defining data schemas with constraints and relationships, then generates test datasets optimized for maximum code coverage and fault detection.

## Features

- **Declarative Schema Definition** - Define entities, types, constraints, and relationships in a clean, readable syntax
- **Smart Generation Strategies** - Choose between `random`, `boundary`, `partition`, or `smart` (combined) strategies
- **Built-in Data Types** - Support for common types: `uuid`, `email`, `fullName`, `date`, `number`, `boolean`, `enum`, and more
- **Entity Relationships** - Define references between entities with automatic foreign key generation
- **Edge Case Support** - Explicitly include `null`, `empty`, or `invalid` values for robustness testing
- **Multiple Output Formats** - Generate SQL (PostgreSQL), JSON, and HTML Coverage Reports
- **Reproducible Results** - Seed-based generation for consistent, reproducible test datasets

## Example

This is an example of a test data schema defined using TestDataGen.

### Schema Example (`ecommerce.tdata`)

```
schema Ecommerce {
    
    description: "Test data for e-commerce application"
    seed: 12345
    strategy: smart
    
    entity User {
        id: uuid
        
        email: email {
            unique: true
            include: [null, empty, invalid]
        }
        
        age: number range 18-120 {
            boundary: true
            partitions: 3
        }
        
        status: enum ["active", "inactive", "banned"] {
            coverage: all
        }
        
        created_at: date range "2020-01-01" to "2025-12-31" {
            boundary: true
        }
        
        generate: 50
    }
    
    entity Product {
        id: uuid
        name: productName
        
        price: number range 0.01-9999.99 {
            boundary: true
            precision: 2
        }
        
        stock: number range 0-1000 {
            boundary: true
            special: [0, 1, 999, 1000]
        }
        
        is_available: boolean {
            coverage: all
        }
        
        generate: 100
    }
    
    entity Order {
        id: uuid
        user: ref User
        
        items: ref Product[] count 1-10 {
            boundary: true
        }
        
        total: number range 0.01-99999.99 {
            boundary: true
            precision: 2
        }
        
        status: enum ["pending", "processing", "shipped", "delivered", "cancelled"] {
            coverage: all
        }
        
        generate: 200
    }
}
```

### Generated SQL Example (`seed.sql`)

```sql
-- Generated by TestDataGen
-- Schema: Ecommerce
-- Strategy: smart (BVA + Equivalence Partitioning)
-- Seed: 12345

-- Users table
INSERT INTO users (id, email, age, status, created_at) VALUES
('a1b2c3d4-e5f6-7890-abcd-ef1234567890', 'john.doe@email.com', 18, 'active', '2020-01-01'),
('b2c3d4e5-f6a7-8901-bcde-f12345678901', 'jane.smith@email.com', 19, 'inactive', '2020-01-02'),
('c3d4e5f6-a7b8-9012-cdef-123456789012', NULL, 69, 'banned', '2022-06-15'),
('d4e5f6a7-b8c9-0123-def0-234567890123', '', 119, 'active', '2025-12-30'),
('e5f6a7b8-c9d0-1234-ef01-345678901234', 'invalid-email', 120, 'inactive', '2025-12-31'),
-- ... more rows with boundary and partition values
;

-- Products table
INSERT INTO products (id, name, price, stock, is_available) VALUES
('f6a7b8c9-d0e1-2345-f012-456789012345', 'Ergonomic Steel Chair', 0.01, 0, true),
('a7b8c9d0-e1f2-3456-0123-567890123456', 'Handmade Wooden Table', 9999.99, 1, false),
-- ... more rows
;

-- Orders table
INSERT INTO orders (id, user_id, total, status) VALUES
('b8c9d0e1-f2a3-4567-1234-678901234567', 'a1b2c3d4-e5f6-7890-abcd-ef1234567890', 0.01, 'pending'),
-- ... more rows
;

-- Order items (junction table)
INSERT INTO order_items (order_id, product_id) VALUES
('b8c9d0e1-f2a3-4567-1234-678901234567', 'f6a7b8c9-d0e1-2345-f012-456789012345'),
-- ... more rows
;
```

### Generated Coverage Report Example

The HTML coverage report shows which test cases were generated:

| Entity | Field | Strategy | Boundary Values | Partitions | Edge Cases | Coverage |
|--------|-------|----------|-----------------|------------|------------|----------|
| User | age | BVA + EP | 17, 18, 19, 119, 120, 121 | [18-51], [52-85], [86-120] | - | 100% |
| User | email | Edge Cases | - | - | null, empty, invalid | 100% |
| Product | price | BVA | 0.00, 0.01, 0.02, 9999.98, 9999.99, 10000.00 | - | - | 100% |
| Order | items | BVA | count: 0, 1, 2, 9, 10, 11 | - | - | 100% |

## Grammar

The TestDataGen language consists of two main parts:

1. **Schema Definition** - Metadata, global settings, and generation strategy
2. **Entity Declarations** - Define entities with fields, types, constraints, and relationships

### Supported Data Types

| Type | Description | Example |
|------|-------------|---------|
| `uuid` | UUID v4 identifier | `a1b2c3d4-e5f6-7890-...` |
| `email` | Email address | `john.doe@email.com` |
| `fullName` | Full person name | `John Doe` |
| `firstName` | First name | `John` |
| `lastName` | Last name | `Doe` |
| `number` | Numeric value (with optional range) | `42`, `3.14` |
| `boolean` | Boolean value | `true`, `false` |
| `date` | Date (with optional range) | `2024-01-15` |
| `datetime` | Date and time | `2024-01-15T10:30:00` |
| `enum` | Enumerated value | `["active", "inactive"]` |
| `string` | Text (with optional length) | `Lorem ipsum...` |
| `productName` | Product name | `Ergonomic Steel Chair` |
| `companyName` | Company name | `Acme Corporation` |
| `address` | Street address | `123 Main St` |
| `city` | City name | `New York` |
| `country` | Country name | `United States` |
| `phone` | Phone number | `+1-555-123-4567` |
| `url` | URL | `https://example.com` |
| `ref` | Reference to another entity | `ref User` |

### Generation Strategies

| Strategy | Description |
|----------|-------------|
| `random` | Pure random generation using Faker |
| `boundary` | Boundary Value Analysis - generates min, min+1, max-1, max, and invalid boundaries |
| `partition` | Equivalence Partitioning - divides range into classes and picks representatives |
| `smart` | Combines BVA + EP + Edge Cases for maximum coverage |

## Instructions

### Prerequisites

- Python 3.8+
- pip

### Installation

1. Clone the repository
```bash
git clone https://github.com/spasoje2001/testdatagen.git
cd testdatagen
```

2. Install dependencies
```bash
pip install -r requirements.txt
```

3. Install TestDataGen CLI
```bash
pip install -e .
```

### Usage

Generate test data from a schema file:

```bash
testdatagen generate ecommerce.tdata --output ./output --format sql,json,report
```

#### CLI Options

| Option | Description | Default |
|--------|-------------|---------|
| `--output`, `-o` | Output directory for generated files | Current directory |
| `--format`, `-f` | Output formats (comma-separated): `sql`, `json`, `report` | `sql` |
| `--seed`, `-s` | Override seed for reproducible generation | Schema seed or random |
| `--overwrite` | Overwrite existing files | `false` |

#### Examples

Generate only SQL:
```bash
testdatagen generate schema.tdata --format sql
```

Generate all formats with custom seed:
```bash
testdatagen generate schema.tdata --format sql,json,report --seed 42
```

Validate schema without generating:
```bash
testdatagen validate schema.tdata
```

## Project Structure

_To be added_

## Technologies Used

- **Python 3.8+** - Primary implementation language
- **[textX](https://github.com/textX/textX)** - DSL framework for grammar definition and parsing
- **[Faker](https://github.com/joke2k/faker)** - Realistic fake data generation
- **[Jinja2](https://jinja.palletsprojects.com/)** - Template engine for output generation


## Contributors

- [Spasoje Brborić](https://github.com/spasoje2001)
- [Luka Zelović](https://github.com/Zela11)
- [Milica Đumić](https://github.com/dumitka)
- [Luka Milanko](https://github.com/Lukaa01)

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
